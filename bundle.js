(()=>{"use strict";class e{constructor(e,t){this._formElement=e.formElement,this._inputElement=e.inputElement,this._buttonElement=e.buttonElement,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorShowClass=e.errorShowClass,this._errorClass=e.errorClass,this._targetFormElement=t,this._inputList=Array.from(t.querySelectorAll(this._inputElement)),this._button=t.querySelector(this._buttonElement)}_showInputError(e,t){const s=this._targetFormElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorShowClass)}_hideInputError(e){const t=this._targetFormElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorShowClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._button.classList.add(this._inactiveButtonClass),this._button.setAttribute("disabled",!0)):(this._button.classList.remove(this._inactiveButtonClass),this._button.removeAttribute("disabled"))}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetErrors(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}enableValidation(){this.resetErrors(this._targetFormElement),this._setEventListeners(this._targetFormElement)}}class t{constructor({data:e,handleCardClick:t},s){this._name=e.name,this._alt=e.name,this._link=e.link,this._handleCardClick=t,this._cardSelector=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(".element__title").textContent=this._name,this._element.querySelector(".element__photo").src=this._link,this._element.querySelector(".element__photo").alt=this._name,this._element}_handleHeartClick(){this._element.querySelector(".element__heart").classList.toggle("element__heart_active")}_handleTrashClick(){this._element.remove()}_setEventListeners(){this._element.querySelector(".element__heart").addEventListener("click",(()=>{this._handleHeartClick()})),this._element.querySelector(".element__trash").addEventListener("click",(()=>{this._handleTrashClick()})),this._element.querySelector(".element__photo").addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)}))}}const s={formElement:".popup__form",inputElement:".popup__field",buttonElement:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__field_type_error",errorShowClass:"error_type_visible"},r="popup_opened",n=document.querySelector(".popup__form_type_profile"),o=document.querySelector(".popup__form_type_add"),i=(o.querySelector(".popup__field_type_title"),o.querySelector(".popup__field_type_link"),n.querySelector(".popup__field_type_name")),l=n.querySelector(".popup__field_type_about"),a=document.querySelector(".profile__button-pen"),p=document.querySelector(".profile__button-plus");document.querySelector(".popup_type_profile"),document.querySelector(".popup_type_card-add"),document.querySelector(".popup_type_picture");class _{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add(r),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove(r),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close-btn"))&&this.close()}))}}class u extends _{constructor(e,t){super(e),this._form=this._popup.querySelector(".popup__form"),this._handleFormSubmit=t,this._input=Array.from(this._form.querySelectorAll(".popup__field"))}close(){super.close(),this._form.reset()}_getInputValues(){const e={};return this._input.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const c=new e(s,o),h=new e(s,n);h.enableValidation(),c.enableValidation();const d=new class{constructor(e,t){this._nameElement=document.querySelector(e),this._aboutElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutElement.textContent}}setUserInfo(e){this._nameElement.textContent=e.name,this._aboutElement.textContent=e.about}}(".profile__name",".profile__about"),m=new u(".popup_type_profile",(function(e){d.setUserInfo(e),m.close()}));m.setEventListeners(),a.addEventListener("click",(function(){const e=d.getUserInfo();i.value=e.name,l.value=e.about,h.resetErrors(n),m.open()}));const E=new u(".popup_type_card-add",(function(e){C.setItem(f(e)),E.close()}));function y(e,t){v.open(e,t)}E.setEventListeners(),p.addEventListener("click",(function(){c.resetErrors(o),E.open()}));const v=new class extends _{constructor(e){super(e),this._image=this._popup.querySelector(".popup__picture"),this._text=this._popup.querySelector(".popup__title-picture")}open(e,t){this._image.src=t,this._image.alt=e,this._text.textContent=e,super.open()}}(".popup_type_picture");v.setEventListeners();const f=e=>new t({data:e,handleCardClick:y},"#element-template").generateCard(),C=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}setItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{C.setItem(f(e))}},".elements");C.renderItems()})();